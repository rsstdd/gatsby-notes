---
title: "Node.js And Express.js Web Server Checklist"
cover: " 	https://s3.amazonaws.com/rsstdd-portfolio/nodejs.png"
date: "02/02/2018"
category: "tech"
tags:
    - programming
    - javascript
    - node
---

# Node.js And Express.js Web Server Checklist

---

| __What__                                                                                                                                                                                                                      |  __Why__                                                                                                                                                                                                                                                                                                                           |  __How__                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Initialize a package.json file                                                                                                                                                                                               | It holds the dependencies as well as general project information                                                                                                                                                                                                                                                                 | `$ npm init -y`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| gitignore                                                                                                                                                                                                                    | Specify which files are ignored in a git repository                                                                                                                                                                                                                                                                              |  ```echo '.DS_Store' >> .gitignore echo 'node_modules' >> .gitignore echo 'npm-debug.log' >> .gitignore ```                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Install Express                                                                                                                                                                                                              | We will use it for our server                                                                                                                                                                                                                                                                                                    | $ npm install --save express                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Install knex                                                                                                                                                                                                                 | Convenient library for database queries                                                                                                                                                                                                                                                                                          | $ npm install --save knex                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Create a server.js file                                                                                                                                                                                                      | For starting the server                                                                                                                                                                                                                                                                                                          | $ touch server.js                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Create a database                                                                                                                                                                                                            | Saving important data                                                                                                                                                                                                                                                                                                            | $ createdb DATABASE_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Add Knex.js to NPM scripts                                                                                                                                                                                                   | Convenient way to run knex in the terminal locally                                                                                                                                                                                                                                                                               | In package.json...“scripts”: {,“knex”: “knex”}...                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Create a knexfile.js                                                                                                                                                                                                         | So that we can connect to the right database                                                                                                                                                                                                                                                                                     | $ atom knexfile.js                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Create a knex.js                                                                                                                                                                                                             | Initializes a knex module to use for querying in your server                                                                                                                                                                                                                                                                     | $ atom knex.js                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Create migration files                                                                                                                                                                                                       | To create tables for database                                                                                                                                                                                                                                                                                                    | $ npm run knex migrate:make NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Create Seed Files                                                                                                                                                                                                            | To have test data for tables                                                                                                                                                                                                                                                                                                     | $ npm run knex seed:make 1_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Require “express” in server.js                                                                                                                                                                                               | Need to Run the Server                                                                                                                                                                                                                                                                                                           | const express = require('express');                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Create Routes Folder                                                                                                                                                                                                         | To set up routing for server                                                                                                                                                                                                                                                                                                     | $ mkdir routes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Install dependencies like body-parser, cookie-parser, morgan, boom, humps                                                                                                                                                    | * Body parser parses the request body into json so we can do javascript with it. * Cookie parser parses the cookie header. * Morgan gives you more information on your server. It logs the requests. * Boom is an error creator. * Humps allows you to camelize and decamelize object keys/table keys. It makes the linter happy | $ npm install --save DEPENDENCY_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Require the above dependencies in server.js                                                                                                                                                                                  | Because you need them                                                                                                                                                                                                                                                                                                            | const dependency = require(‘dependency’);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Initialize port variable                                                                                                                                                                                                     | For use in app.listen                                                                                                                                                                                                                                                                                                            | const port = process.env.PORT || 8000;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Initialize express                                                                                                                                                                                                           | You want to start the server                                                                                                                                                                                                                                                                                                     | const app = express(); app.listen(port, () => {   console.log(`Listening on port ${port}`); }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Export the Server                                                                                                                                                                                                            | Allow the server to be accessed by the tests                                                                                                                                                                                                                                                                                     | module.exports = app;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Use bodyParser as Middleware                                                                                                                                                                                                 | You need to parse the body.                                                                                                                                                                                                                                                                                                      | `app.use(bodyParser());`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Add Not Found Error Handler                                                                                                                                                                                                  | For all 404 scenarios                                                                                                                                                                                                                                                                                                            | `app.use((req, res)  => {      res.sendStatus(404); });                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Use Morgan as Middleware                                                                                                                                                                                                     | Allows logging request information                                                                                                                                                                                                                                                                                               | `app.use(morgan('dev'));`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Use the Cookie parser                                                                                                                                                                                                        | Parses cookies                                                                                                                                                                                                                                                                                                                   | `app.use(cookieParser());                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Add default error handler                                                                                                                                                                                                    | Handles non 404 Errors                                                                                                                                                                                                                                                                                                           | ```jsapp.use((err, _req, res, _next) => {         if (err.output && err.output.statusCode) {              return res                         .status(err.output.statusCode)                         .set('Content-Type', 'text/plain')                         .send(err.message);         }         if(err.status) {               return res                         .status(err.status)                         .set('Content-Type', 'text/plain')                         .send(err.errors[0].messages[0])         }          // eslint-disable-next-line no-console          console.error(err.stack);          res.sendStatus(500); }); ``` |
| Initialize Public Directory with Static Files                                                                                                                                                                                | Allows the browser to access those files on the Server                                                                                                                                                                                                                                                                           | ```js const path = require('path'); app.use(express.static('path.join('public))); ```                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Disable x-powered-by                                                                                                                                                                                                         | Disables the x-powered-by header in the response                                                                                                                                                                                                                                                                                 | `app.disable(‘x-powered-by’);`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Set Up Routes                                                                                                                                                                                                                | Allow the Server to Access different paths                                                                                                                                                                                                                                                                                       |  `$touch routes/ROUTE` ```js const ROUTE = require('./routes/ROUTE; app.use(ROUTE); ```                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Handle CSRF (Cross-Site Request Forgery)   * type of attack that occurs when a malicious website/program causes a web browser to perform an unwanted action on a trusted site for which the user is currently authenticated. | Security Reasons                                                                                                                                                                                                                                                                                                                 | ```js app.use((req, res, next => {      }); ```                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| IF AUTHENTICATION Initialize dotenv                                                                                                                                                                                          | Reads .env file for JWT_SECRET_KEY which does NOT get included in git                                                                                                                                                                                                                                                            | ``` $ touch .env $ echo '.env' >> .gitignore $ npm install --save dotenv ``` ```js if (process.env.NODE_ENV !== 'production') {     require('dotenv').config(); } ```                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| __For Routes__                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Require the Dependencies                                                                                                                                                                                                     | You need them                                                                                                                                                                                                                                                                                                                    | ```js const boom = require('boom'); const express = require('express') ;const knex = require('../knex'); const { camelizeKeys, decamelizeKeys } = require('humps'); const ev = require('express-validation'); const validations = require('../validations/books'); ```                                                                                                                                                                                                                                                                                                                                                                            |
| Create the Router                                                                                                                                                                                                            | Stores routes in a separate module, so we do not have to put them all in server.js                                                                                                                                                                                                                                               | ```js const router  = express.Router();  // Some CRUD here  module.exports = router;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Initialize routes with express-validation                                                                                                                                                                                    | Simplifies validation based on a schema definition.                                                                                                                                                                                                                                                                              |  ```js router.METHOD(PATH, ev(validations.METHOD), (req, res, next) => {  ..... }); ```                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
